- project:
    templates:
      - check-requirements
      - openstack-cover-jobs
      - openstack-lower-constraints-master-branch-jobs
      - openstack-python3-yoga-jobs
      - publish-openstack-docs-pti
      - release-notes-jobs-python3
    check:
      jobs:
        # NOTE(rpittau): yoga jobs support py38 and py39 but we want to keep
        # testing py36 to maintain compatibility with older distributions like
        # CentOS Stream 8, Ubuntu Bionic, Debian 10, and openSuse Leap
        # Remove after Yoga
        - openstack-tox-py36
        - openstack-tox-functional
        - ipa-tox-examples
        # NOTE(iurygregory) Only run this two jobs since we are testing
        # wholedisk + partition on tempest
        - ipa-tempest-bios-ipmi-direct-src
        - ipa-tempest-uefi-redfish-vmedia-src
        - metalsmith-integration-ipa-src-uefi
        # NOTE(TheJulia): The cleaning tests run in standalone job has a
        # high failure rate due to possible race during long running steps
        # like deployment with raid setup. While we're working on a fix,
        # we also need to fix IPA and Ironic itself, so this is as a result
        # temporary.
        - ironic-standalone-ipa-src:
            voting: false
        # NOTE(dtantsur): non-voting because IPA source code is very unlikely
        # to break them. They rather serve as a canary for broken POST jobs.
        - ironic-python-agent-check-image-tinyipa:
            voting: false
        - ironic-python-agent-check-image-dib-centos8:
            voting: false
        # Non-voting jobs
        - ipa-tempest-ironic-inspector-src:
            voting: false
        - ipa-tox-bandit:
            voting: false
    gate:
      queue: ironic
      jobs:
        # NOTE(rpittau): yoga jobs support py38 and py39 but we want to keep
        # testing py36 to maintain compatibility with older distributions like
        # CentOS Stream 8, Ubuntu Bionic, Debian 10, and openSuse Leap
        # Remove after Yoga
        - openstack-tox-py36
        - openstack-tox-functional
        - ipa-tempest-bios-ipmi-direct-src
        - ipa-tempest-uefi-redfish-vmedia-src
        - metalsmith-integration-ipa-src-uefi
    post:
      jobs:
        - ironic-python-agent-build-image-tinyipa
        - ironic-python-agent-build-image-dib-centos8
